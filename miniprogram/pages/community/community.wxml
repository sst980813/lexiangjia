<!--community.wxml-->
<view class="page-container">
  <navigation-bar title="ç¤¾åŒº" back="{{false}}" color="#8B5A3C" background="#F7E6D3"></navigation-bar>
  
  <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
  <view class="main-content {{safeAreaClass}}" style="{{safeAreaStyle}}">
    <scroll-view class="scroll-container" scroll-y type="list">
      
      <!-- é¡¶éƒ¨å¯¼èˆªåˆ‡æ¢ -->
      <view class="tab-nav">
        <view class="nav-item {{currentTab == 0 ? 'active' : ''}}" bindtap="onNavTap" data-index="0">
          <text class="nav-text">å…´è¶£ç¤¾ç¾¤</text>
        </view>
        <view class="nav-item {{currentTab == 1 ? 'active' : ''}}" bindtap="onNavTap" data-index="1">
          <text class="nav-text">ä¸»é¢˜æ´»åŠ¨</text>
        </view>
      </view>
      
      <!-- å…´è¶£ç¤¾ç¾¤å†…å®¹ -->
      <view class="content-section" wx:if="{{currentTab == 0}}">
        
        <!-- æˆ‘çš„ç¤¾ç¾¤ -->
        <view class="my-groups-section" wx:if="{{myGroups.length > 0}}">
          <view class="section-header">
            <text class="section-title">æˆ‘çš„ç¤¾ç¾¤</text>
          </view>
          <view class="groups-scroll">
            <view class="group-item my-group" wx:for="{{myGroups}}" wx:key="id" bindtap="onGroupTap" data-group="{{item}}">
              <view class="group-icon">{{item.icon}}</view>
              <text class="group-name">{{item.name}}</text>
              <text class="group-members">{{item.memberCount}}äºº</text>
            </view>
          </view>
        </view>
        
        <!-- æ¨èç¤¾ç¾¤ -->
        <view class="groups-section">
          <view class="section-header">
            <text class="section-title">æ¨èç¤¾ç¾¤</text>
            <text class="section-subtitle">æ‰¾åˆ°å¿—åŒé“åˆçš„æœ‹å‹</text>
          </view>
          
          <view class="groups-grid">
            <view class="group-card" wx:for="{{interestGroups}}" wx:key="id" bindtap="onGroupDetailTap" data-group="{{item}}">
              <view class="group-header">
                <view class="group-icon-large">{{item.icon}}</view>
                <view class="group-info">
                  <text class="group-title">{{item.name}}</text>
                  <text class="group-desc">{{item.description}}</text>
                  <view class="group-meta">
                    <text class="member-count">ğŸ‘¥ {{item.memberCount}}äºº</text>
                    <text class="activity-level">ğŸ”¥ {{item.activityLevel}}</text>
                  </view>
                </view>
              </view>
              
              <!-- æœ€æ–°åŠ¨æ€é¢„è§ˆ -->
              <view class="recent-post" wx:if="{{item.recentPost}}">
                <text class="post-content">{{item.recentPost.content}}</text>
                <text class="post-time">{{item.recentPost.time}}</text>
              </view>
              
              <view class="group-actions">
                <button class="join-btn {{item.joined ? 'joined' : ''}}" bindtap="onJoinGroup" data-group="{{item}}" catchtap="true">
                  {{item.joined ? 'å·²åŠ å…¥' : 'ç”³è¯·åŠ å…¥'}}
                </button>
              </view>
            </view>
          </view>
        </view>
      </view>
      
      <!-- ä¸»é¢˜æ´»åŠ¨å†…å®¹ -->
      <view class="content-section" wx:if="{{currentTab == 1}}">
        
        <!-- æˆ‘çš„æ´»åŠ¨ -->
        <view class="my-activities-section" wx:if="{{myActivities.length > 0}}">
          <view class="section-header">
            <text class="section-title">æˆ‘çš„æ´»åŠ¨</text>
          </view>
          <view class="activity-item my-activity" wx:for="{{myActivities}}" wx:key="id" bindtap="onActivityTap" data-activity="{{item}}">
            <view class="activity-status {{item.status}}">{{item.statusText}}</view>
            <text class="activity-title">{{item.title}}</text>
            <text class="activity-time">ğŸ“… {{item.time}}</text>
          </view>
        </view>
        
        <!-- æ¨èæ´»åŠ¨ -->
        <view class="activities-section">
          <view class="section-header">
            <text class="section-title">ç²¾å½©æ´»åŠ¨</text>
            <text class="section-subtitle">ä¸°å¯Œæ‚¨çš„é€€ä¼‘ç”Ÿæ´»</text>
          </view>
          
          <view class="activities-list">
            <view class="activity-card" wx:for="{{themeActivities}}" wx:key="id" bindtap="onActivityDetailTap" data-activity="{{item}}">
              <view class="activity-image">
                <image src="{{item.image}}" mode="aspectFill"></image>
                <view class="activity-type">{{item.type}}</view>
              </view>
              
              <view class="activity-content">
                <text class="activity-title">{{item.title}}</text>
                <text class="activity-desc">{{item.description}}</text>
                
                <view class="activity-details">
                  <view class="detail-item">
                    <text class="detail-label">ğŸ“… æ—¶é—´</text>
                    <text class="detail-value">{{item.time}}</text>
                  </view>
                  <view class="detail-item">
                    <text class="detail-label">ğŸ“ åœ°ç‚¹</text>
                    <text class="detail-value">{{item.location}}</text>
                  </view>
                  <view class="detail-item">
                    <text class="detail-label">ğŸ‘¥ äººæ•°</text>
                    <text class="detail-value">{{item.participants}}/{{item.maxParticipants}}</text>
                  </view>
                  <view class="detail-item" wx:if="{{item.needCompanion}}">
                    <text class="companion-tag">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å»ºè®®å®¶å±é™ªåŒ</text>
                  </view>
                </view>
                
                <view class="activity-actions">
                  <button class="participate-btn {{item.participated ? 'participated' : ''}}" bindtap="onParticipateActivity" data-activity="{{item}}" catchtap="true">
                    {{item.participated ? 'å·²æŠ¥å' : 'ç«‹å³æŠ¥å'}}
                  </button>
                  <view class="activity-price" wx:if="{{item.price > 0}}">
                    <text class="price-label">è´¹ç”¨</text>
                    <text class="price-value">Â¥{{item.price}}</text>
                  </view>
                  <view class="activity-price free" wx:else>
                    <text class="price-value">å…è´¹</text>
                  </view>
                </view>
              </view>
            </view>
          </view>
        </view>
      </view>
      
    </scroll-view>
  </view>
</view>
